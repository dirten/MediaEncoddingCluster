
<script type="text/javascript">

  function onGridSelect(evt)
  {
    /*
    var str = 'row: '+evt.row+' indices: '+evt.indices;
    str += ' id: '+evt.target.getDataByRow(evt.row).id;

    alert( str );
     */
    //  alert('hier');
    var url='/api/json/profile';
    var request = new Request.JSON({
      url: url,
      method: 'get',
      onComplete: function(properties) {
        setProfileDetails(properties);
      }
    }).send('id='+evt.target.getDataByRow(evt.row).id);


  }
  function openProfileForm(evt){
    new MochaUI.Window({
      id: 'profile',
      title: 'Profile Builder',
      icon: 'images/icons/page.gif',
      scrollbars:true,
      loadMethod: 'xhr',
      contentURL: 'pages/profileform.html',
      onContentLoaded: function(){
        new Request.JSON({
          url: '/api/json/profile',
          method: 'get',
          onComplete: function(properties) {
            setProfileFormData(properties);
          }
        }).send('id='+evt.target.getDataByRow(evt.row).id);
        //        $('profileId').set('value',evt.target.getDataByRow(evt.row).id);

      },
      width: 400,
      height: 500,
      maximizable: false,
      resizable: false,
      scrollbars: false
    });
  }


  function gridButtonClick(button, grid)
  {
    alert(button);
  }

  var cmu = [
    {
      header: "Id",
      dataIndex: 'id',
      dataType:'number',
      width:30
    },
    {
      header: "Name",
      dataIndex: 'name',
      dataType:'string',
      width:350
    },
    {
      header: "Extension",
      dataIndex: 'ext',
      dataType:'string',
      width:50
    },
    {
      header: "Video Format",
      dataIndex: 'vformat',
      dataType:'string',
      width:80
    },
    {
      header: "Video Codec",
      dataIndex: 'vcodec',
      dataType:'string',
      width:80
    }

  ];

  window.addEvent("domready", function(){
 
    profilegrid = new omniGrid('encodinggrid', {

      columnModel: cmu,
      /*
      buttons : [
        {name: 'Add', bclass: 'add', onclick : gridButtonClick},
        {name: 'Delete', bclass: 'delete', onclick : gridButtonClick},
        {separator: true},
        {name: 'Duplicate', bclass: 'duplicate', onclick : gridButtonClick}
      ],*/
      url:"/api/json/profile",
      method:'get',
      perpage:10,
      page:1,
      pagination:false,
      serverSort:false,
      showHeader: true,
      alternaterows: true,
      
      sortHeader:true,
      resizeColumns:true,
      multipleSelection:false,

      // uncomment this if you want accordion behavior for every row
      /*
	        accordion:true,
	        accordionRenderer:accordionFunction,
	        autoSectionToggle:false,
       */

      width:800,
      height: null
    });

    profilegrid.addEvent('click', onGridSelect);
    profilegrid.addEvent('dblclick', openProfileForm);
    $('createNewProfileButton').addEvent('click', function(e){
      new Event(e).stop();
      MochaUI.profileWindow();
    });

  });

</script>
<button class="add" id="createNewProfileButton">Create Profile ...</button>
<div id="encodinggrid" ></div>

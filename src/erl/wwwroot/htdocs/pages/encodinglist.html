<link rel="stylesheet" media="screen" href="omnigrid/omnigrid.css" type="text/css" />
<!--
<script type="text/javascript" src="scripts/mootools-1.2-core.js"></script>
<script type="text/javascript" src="scripts/mootools-1.2-more.js"></script>
<script type="text/javascript" src="../omnigrid/omnigrid.js"></script>
-->
<script type="text/javascript">

  function onGridSelect(evt)
  {
        var url='/api/json/get_file_detail';
        var request = new Request.JSON({
          url: url,
          method: 'get',
          onComplete: function(properties) {
            var l=properties.id;
//            alert(l);
//            var myElement=new Element('div',{id:'testid', text:l});
              setFileDetails(properties);
//            $('fileid').set('text',properties.id);
//            $('filepath').set('text',properties.path);
//            $('filename').set('text',properties.filename);
/*
appendChild(new Element('div',{id:'testid', text:properties.id})).
              appendChild(new Element('div',{id:'testid', text:properties.path})).
              appendChild(new Element('div',{id:'testid', text:properties.filename})).
              appendChild(new Element('div',{id:'testid', text:properties.containertype})).
              appendChild(new Element('div',{id:'testid', text:properties.streamcount}))
              ;*/
//            myElement.inject($('filedetail'));
            //            MochaUI.newWindowsFromJSON(properties.windows);
          }
        }).send('id='+evt.target.getDataByRow(evt.row).id);
//
    /*
         var str = 'row: '+evt.row+' indices: '+evt.indices;
         str += ' id: '+evt.target.getDataByRow(evt.row).id;

         alert( str );
     */
  }

  function gridButtonClick(button, grid)
  {
    alert(button);
  }

  var cmu = [
    {
      header: "Source File",
      dataIndex: 'source',
      dataType:'number',
      width:30
    },
    {
      header: "Target File",
      dataIndex: 'target',
      dataType:'number',
      width:30
    },
    {
      header: "Start Time",
      dataIndex: 'start',
      dataType:'string',
      width:200
    },
    {
      header: "End Time",
      dataIndex: 'endtime',
      dataType:'string',
      width:200
    },
    {
      header: "% Done",
      dataIndex: 'complete',
      dataType:'number'
    }

  ];
/*
  $('encodinggrid').addEvent("blur",function(){
    MochaUI.notification('Window lost focus.');
  });
*/
  window.addEvent("domready", function(){

    var datagrid = new omniGrid('encodinggrid', {
      columnModel: cmu,
      /*
      buttons : [
        {name: 'Add', bclass: 'add', onclick : gridButtonClick},
        {name: 'Delete', bclass: 'delete', onclick : gridButtonClick},
        {separator: true},
        {name: 'Duplicate', bclass: 'duplicate', onclick : gridButtonClick}
      ],*/
      url:"/api/json/get_encoding_list",
      perpage:10,
      page:1,
      pagination:false,
      serverSort:false,
      showHeader: true,
      alternaterows: true,
      showHeader:true,
      sortHeader:true,
      resizeColumns:true,
      multipleSelection:false,

      // uncomment this if you want accordion behavior for every row
      /*
	        accordion:true,
	        accordionRenderer:accordionFunction,
	        autoSectionToggle:false,
       */

      width:800,
      height: null
    });
   
    datagrid.addEvent('click', onGridSelect);
    var myRefresh = function(){  this.refresh();};
    myRefresh.periodical(2000, datagrid);
//    datagrid.refresh.periodical(2000);
  });

</script>

<div id="encodinggrid" ></div>
